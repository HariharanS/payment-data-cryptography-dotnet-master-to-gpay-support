# Google Pay - payment data cryptography in C# ( This is a copy of GitHub repo https://github.com/google-pay/payment-data-cryptography-dotnet )

## Overview

.NET idiomatic library that performs the steps outlined in [Payment data cryptography](https://developers.google.com/pay/api/web/guides/resources/payment-data-cryptography).
It allows you to decrypt and verify a `PaymentMethodToken` object generated by
the Google Pay API. It supports versions `ECv1` and `ECv2`.

Internally, it relies on [Bouncy Castle C#](https://www.bouncycastle.org/csharp/index.html)
and has no other external dependencies.

## Sample use

```
// To use INSTANCE_TEST, set the parameter to true
var keyProvider = new GooglePay.PaymentDataCryptography.GoogleKeyProvider(false);
var parser = new GooglePay.PaymentDataCryptography.PaymentMethodTokenRecipient("merchant:YOUR_MERCHANT_ID", keyProvider);
parser.AddPrivateKey(PrivateKey1);
parser.AddPrivateKey(PrivateKey2);
string decryptedMessage = parser.Unseal(encryptedMessage);
```

## Disclaimer

This is not an official Google product.

[Tink](https://github.com/google/tink) is the library actively maintained and
supported by the Google Pay team. Using Tink to perform payment data
cryptography for Google Pay is highly recommended.

## Caller Project 
It was added to call the sample implementation API to decrypt the payload
```
// openssl pkcs8 -topk8 -inform PEM -outform DER -in key.pem -nocrypt | base64 | paste -sd "\0" -
        private const string base64PrivateKey = "";

        static void Main(string[] args)
        {
            //load the decrypted payload
            string payload1 = File.ReadAllText("payload1.txt");
            //true -> test, leave empty in prodcde
            var keyProvider = new GoogleKeyProvider(true);

            var parser = new PaymentMethodTokenRecipient("gateway:eway", keyProvider);

            parser.AddPrivateKey(base64PrivateKey);

            var plainText = parser.Unseal(payload1);

            Console.WriteLine(plainText);
        }
```
